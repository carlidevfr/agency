{# Menu #}
<a href="{{base_url}}">Accueil</a>
<a href="{{base_url}}/admin">Admin</a>
<br><br>

{# Titre de la page #}
<h1>Gestion des
	{{pageName}}</h1>

{# Page 'résultat' suite à une action créer, update ou delete terminée #}
{% if addResult is defined and addResult is not empty %}

	{# résultat de l'action #}
	{{addResult}}
	<br>

	{# Liste des éléments liés pouvant empêcher la suppression #}
	{% if data is defined and data is not empty %}
		<h2>Liaisons relatives à l'élément à supprimer</h2>
		<h3>Peut empêcher la suppression :</h3>

		{% for tableName, items in data %}

			{# utilisé pour Cibles ? #}
			{% if tableName == 'Cibles' and tableName is not empty %}
				<ul>
					{% for cible in items %}
						<li>Nom de la cible:
							{{ cible.firstname }}
							{{ cible.lastname }}
						</li>
					{% endfor %}
				</ul>

			{# utilisé pour Planques ? #}
			{% elseif tableName == 'Planques' and tableName is not empty %}
				<ul>
					{% for planque in items %}
						<li>Planque :
							{{ planque.planqueName }}</li>
					{% endfor %}
				</ul>

			{# utilisé pour Missions ? #}
			{% elseif tableName == 'Missions' and tableName is not empty %}
				<ul>
					{% for mission in items %}
						<li>Mission :
							{{ mission.title }}</li>
					{% endfor %}
				</ul>

			{% endif %}
		{% endfor %}
	{% endif %}
	<a href="{{ base_url }}{{previousUrl}}">Retour</a>

	{# Page 'update' pour mettre le nouveau nom #}
{% elseif modifySection is defined and modifySection == true %}
	<h2>Modification
		{{pageName}}:</h2>
	Ancien nom :
	{{elements.valeur}}
	<br><br>
	Nouveau nom :
	<br>
	<form action="{{base_url}}{{updateUrl}}" method="post">
		<input type="text" name="updatedName" id="">
		<input type="hidden" name="updateElementId" value={{ elements.id }}>
		<input type="hidden" name="tok" value={{ token }}>

		<button type="submit">Soumettre</button>

	</form>
	<a href="{{ base_url }}{{previousUrl}}">Retour</a>

	{# Page 'main' de la section avec CRUD #}
{% else %}

	<h2>liste des
		{{pageName}}</h2>

	{# Formulaire de recherche #}
	<form action="{{base_url}}{{previousUrl}}" method="get">
		<input type="text" name='search'>
		<input type="hidden" name="tok" value={{ token }}>
		<button type="submit">Recherche
			{{pageName}}</button>
		<button onclick="location.href='{{ base_url }}{{previousUrl}}'">Reset</button>
	</form>

	{% if elements == 'une erreur est survenue' %}
		<b>une erreur est survenue</b>
	{% else %}

		{# Tableau des éléments #}
		<table>
			<thead>
				<tr>
					<th>Nom
						{{pageName}}</th>
					<th>Modifier</th>
					<th>Supprimer</th>
				</tr>
			</thead>
			<tbody>
				{% for element in elements %}
					<tr>
						<td>{{ element.valeur }}</td>
						<td>
							<form method="get" action="{{base_url}}{{updateUrl}}">
								<input type="hidden" name="UpdateElementId" value={{ element.id }}>
								<input type="hidden" name="tok" value={{ token }}>
								<button type="submit">Modifier</button>
							</form>
						</td>
						<td>
							<form method="post" action="{{base_url}}{{deleteUrl}}">
								<input type="hidden" name="deleteElementId" value={{ element.id }}>
								<input type="hidden" name="tok" value={{ token }}>
								<button type="submit">Supprimer</button>
							</form>
						</td>
					</tr>
				{% endfor %}
			</tbody>
		</table>

		{# Pagination #}
		<div class="pagination">
			page
			<br>
			{% if activePage > 1 %}
				<a href="?page={{ activePage - 1 }}&search={{search}}">Page précédente</a>
			{% endif %}

			{% for page in 1..pageMax %}
				{% if page == activePage %}
					<span class="current-page">{{ page }}</span>
				{% else %}
					<a href="?page={{ page }}&search={{search}}">{{ page }}</a>
				{% endif %}
			{% endfor %}

			{% if activePage < pageMax %}
				<a href="?page={{ activePage + 1 }}&search={{search}}">Page suivante</a>
			{% endif %}
		</div><br>

		{# Section add #}
		<h2>Souhaitez vous faire un ajout :
			{{pageName}}
			?</h2>
		<form action="{{base_url}}{{addUrl}}" method="post">
			<label for="addElementName">Nom du nouvel élément :
			</label>
			<input type="text" name="addElementName" id="" placeholder="{{pageName}}">
			<input type="hidden" name="tok" value={{ token }}>
			<button type="submit">Soumettre</button>
		</form>
		<br>
		<br>

		{# Retour vers page d'accueil admin #}
		<a href="{{base_url}}/admin">Retour</a>
	{% endif %}
{% endif %}
